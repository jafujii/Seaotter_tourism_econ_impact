legend.title=element_blank(),
strip.text=element_text(hjust=0))
dem<- read.csv(paste0("C:/Users/",Sys.info()[7],"/Seaotter_tourism_econ_impact/data/SurveyData_edits.csv"), header=T)
# Distribution of respondents' age
dem2<- dem %>% filter(!is.na(AGE))
ageden<-ggplot(dem2, aes(x= AGE))+geom_density(alpha=0.3, color= "#026AA4",fill= "#026AA4")+
scale_y_continuous(limits=c(0,0.025), name=" ", breaks=c(0.00,0.01,0.02,0.03))+
geom_rug(aes(x=AGE, y=0), sides="b", position="jitter") + scale_x_continuous(name="Age (years)")+ themeKV
ageden
visden<-ggplot(dem2, aes(x= NVisits))+geom_density( alpha=0.3, color= "#026AA4",fill= "#026AA4")+
geom_rug(aes(x=NVisits, y=0), sides="b", position="jitter") + scale_y_continuous(limits=c(0,0.65), name="")+
scale_x_continuous(name= "Log (Number previous visits)", trans="log1p", labels=scales::label_number(), breaks=c(0, 10,50,100,200)) +
themeKV
visden
incden<- ggplot(dem, aes(x= Income))+geom_density(alpha=0.3, color= "#026AA4",fill= "#026AA4")+
geom_rug(aes(x=Income, y=0), sides="b", position="jitter") + scale_y_continuous(limits=c(0,0.65), name="") +
scale_x_continuous(name= "Log (Annual Income)", trans="log1p", labels=scales::label_number(), breaks=c(10000,50000,150000)) + themeKV
##Party Size density plot with "rug" to show sample data
# Outliers of Party Size were not included in reported averages by Colgan, so also removed here. Likely data entry errors
dem3<- dem %>% filter(Partysize <30)
Psden<- ggplot(dem3, aes(x= Partysize))+geom_density(alpha=0.3, color= "#026AA4",fill= "#026AA4")+
geom_rug(aes(x=Partysize, y=0), sides="b", position="jitter") + scale_y_continuous(limits=c(0,0.45), name="", breaks=c(0.0,0.2,0.4)) +
scale_x_continuous(name= "Party Size") + themeKV
denp2<-(ageden / incden / visden / Psden) # vertical layout
denp2
ggsave("Figure_3_vertical.pdf", width=90, height=190,units="mm",denp2)
## Density plot previous visits on Log scale with "rug" to show sample data
visden<-ggplot(dem2, aes(x= NVisits))+geom_density( alpha=0.3, color= "#026AA4",fill= "#026AA4")+
geom_rug(aes(x=NVisits, y=0), sides="b", position="jitter") + scale_y_continuous(limits=c(0,0.65), breaks=c(0.0,0.3,0.6),name="")+
scale_x_continuous(name= "Log (Number previous visits)", trans="log1p", labels=scales::label_number(), breaks=c(0, 10,50,100,200)) +
themeKV
visden
incden<- ggplot(dem, aes(x= Income))+geom_density(alpha=0.3, color= "#026AA4",fill= "#026AA4")+
geom_rug(aes(x=Income, y=0), sides="b", position="jitter") + scale_y_continuous(limits=c(0,0.65), breaks=c(0.0,0.3,0.6), name="") +
scale_x_continuous(name= "Log (Annual Income)", trans="log1p", labels=scales::label_number(), breaks=c(10000,50000,150000)) + themeKV
denp2<-(ageden / incden / visden / Psden) # vertical layout
denp2
ggsave("Figure_3_vertical.pdf", width=90, height=190,units="mm",denp2)
ggsave("Figure_3_vertical.pdf", width=90, height=190,units="mm",denp2)
## Combining plots together and exporting
denp<- (ageden + Psden)/(incden + visden ) # square layout
denp
ageden<-ggplot(dem2, aes(x= AGE))+geom_density(alpha=0.3, color= "#026AA4",fill= "#026AA4")+
scale_y_continuous(limits=c(0,0.025), name=" ", breaks=c(0.00,0.01,0.02))+
geom_rug(aes(x=AGE, y=0), sides="b", position="jitter") + scale_x_continuous(name="Age (years)")+ themeKV
## Density plot previous visits on Log scale with "rug" to show sample data
visden<-ggplot(dem2, aes(x= NVisits))+geom_density( alpha=0.3, color= "#026AA4",fill= "#026AA4")+
geom_rug(aes(x=NVisits, y=0), sides="b", position="jitter") + scale_y_continuous(limits=c(0,0.65), breaks=c(0.0,0.3,0.6),name="")+
scale_x_continuous(name= "Log (Number previous visits)", trans="log1p", labels=scales::label_number(), breaks=c(0, 10,50,100,200)) +
themeKV
incden<- ggplot(dem, aes(x= Income))+geom_density(alpha=0.3, color= "#026AA4",fill= "#026AA4")+
geom_rug(aes(x=Income, y=0), sides="b", position="jitter") + scale_y_continuous(limits=c(0,0.65), breaks=c(0.0,0.3,0.6), name="") +
scale_x_continuous(name= "Log (Annual Income)", trans="log1p", labels=scales::label_number(), breaks=c(10000,50000,150000)) + themeKV
##Party Size density plot with "rug" to show sample data
# Outliers of Party Size were not included in reported averages by Colgan, so also removed here. Likely data entry errors
dem3<- dem %>% filter(Partysize <30)
Psden<- ggplot(dem3, aes(x= Partysize))+geom_density(alpha=0.3, color= "#026AA4",fill= "#026AA4")+
geom_rug(aes(x=Partysize, y=0), sides="b", position="jitter") + scale_y_continuous(limits=c(0,0.45), name="", breaks=c(0.0,0.2,0.4)) +
scale_x_continuous(name= "Party Size") + themeKV
## Combining plots together and exporting
denp<- (ageden + Psden)/(incden + visden ) # square layout
denp2<-(ageden / incden / visden / Psden) # vertical layout
denp
############## Willingness to Pay Analyses ###############################################
datWTP<-read.csv(paste0("C:/Users/",Sys.info()[7],"/Seaotter_tourism_econ_impact/data/WTPsurvey.csv"), header=T)
dat1<- datWTP %>% dplyr::select(ESR1, ESR2,Income,AGE, ESBID_1,ESBID_2, Attrib_Birds,Attrib_Unique,Attrib_Otter,Attrib_Fish, Attrib_Convenience, NVisits,MBA) %>% drop_na()
datES<- datWTP %>% dplyr::select(ESR1, ESR2,Income, ESBID_1,ESBID_2, Attrib_Birds,Attrib_Unique,Attrib_Otter,
Attrib_Fish, Attrib_Convenience, NVisits,MBA, AGE) %>% drop_na()
ESd0<- dbchoice(ESR1 +ESR2 ~ 1 | ESBID_1 + ESBID_2,dist="logistic",na.rm=TRUE, data=datES)  # Null Model
Esdfull<- dbchoice(ESR1 +ESR2 ~ 1 + log(Income) + log(AGE)+ Attrib_Otter + Attrib_Unique +
Attrib_Convenience +NVisits + MBA| ESBID_1 + ESBID_2,dist="logistic",na.rm=TRUE, data=datES) # All reported factors
Esd1<-dbchoice(ESR1 +ESR2 ~ 1 + log(Income) | ESBID_1 + ESBID_2,dist="logistic",na.rm=TRUE, data=datES) # Reported model
Esd2<-dbchoice(ESR1 +ESR2 ~ 1 + log(Income) + Attrib_Otter  +
Attrib_Convenience  | ESBID_1 + ESBID_2,dist="logistic", na.rm=TRUE, data=datES)
Esd3<-dbchoice(ESR1 +ESR2 ~ 1 + log(Income) + Attrib_Otter | ESBID_1 + ESBID_2,dist="logistic", na.rm=TRUE, data=datES)
AIC(Esd3)
AICc(Esd3)
Esd3
summary(Esd3)
AICc<- AIC(Esd3)+ (2(3)(4)/(144-3-1))
AICc<- AIC(Esd3)+ (24/140)
AICc
set.seed(123)
bootCI(Esd3, nboot = 1000, CI = 0.95, individual = NULL)
datS<- datWTP %>% dplyr::select(OTR1, OTR2,Income, OTBID_1,OTBID_2, Attrib_Birds,Attrib_Unique,Attrib_Otter,Attrib_Fish, Attrib_Convenience, NVisits,MBA) %>% drop_na()
Sdb0<- dbchoice(OTR1 +OTR2 ~ 1 | OTBID_1 + OTBID_2,dist="logistic",na.rm=TRUE, data=datS)
Sdbfull<- dbchoice(OTR1 +OTR2 ~ 1 + log(Income) + Attrib_Otter + Attrib_Unique + Attrib_Birds + Attrib_Fish +
Attrib_Convenience + NVisits +MBA  | OTBID_1 + OTBID_2,dist="logistic", data=datS)
Sdb1<-dbchoice(OTR1 +OTR2 ~ 1 + log(Income) | OTBID_1 + OTBID_2,dist="logistic", data=datS)
Sdb2<-dbchoice(OTR1 +OTR2 ~ 1 + log(Income) + Attrib_Otter  +
Attrib_Convenience  | OTBID_1 + OTBID_2,dist="logistic", data=datS)
Sdb3<-dbchoice(OTR1 +OTR2 ~ 1 + log(Income) + Attrib_Otter  | OTBID_1 + OTBID_2,dist="logistic",na.rm=TRUE, data=datS)
Sdb4<-dbchoice(OTR1 +OTR2 ~ 1 + Attrib_Otter  | OTBID_1 + OTBID_2,dist="logistic", data=datS)
AIC(Sdb0, Sdb1, Sdbfull, Sdb2, Sdb3, Sdb4)
set.seed(123)
bootCI(Sdb3, nboot = 1000, CI = 0.95, individual = NULL)
tst.data<- data.frame(Attrib_Otter= mean(datS$Attrib_Otter), Income= mean(datS$Income), OTBID_1=c(5:50))
Spred<- predict(Sdb3, newdata= tst.data, type="probability")
df<-cbind(tst.data,Spred)
tst.data1<- data.frame(Income=mean(datES$Income), Attrib_Otter=mean(datES$Attrib_Otter), ESBID_1=c(5:50))
Spred1<- Esd3 %>% predict(tst.data1, type="probability")
df1<-cbind(df,Spred1)
Preds<-melt(df1,id.vars=c("Attrib_Otter", "OTBID_1"))
Pred1<-ggplot(Preds, aes(x=OTBID_1, y= value, color=variable)) +geom_smooth(method="loess", size=2) +scale_x_continuous(name="Proposed Fee Amount (USD)") +theme_themeo() +
scale_color_manual(breaks= c("Spred1","Spred"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,1), name="Probability of voting yes") + theme( legend.justification= c(0.9,0.9), legend.position=c(0.9,0.9))
Pred1
tdat<- data.frame(Attrib_Otter= c(1:10), Income= mean(datS$Income), OTBID_1= mean(datS$OTBID_1))
Spr<-predict(Sdb3, newdata=tdat, type= "probability")
df<- cbind(tdat, Spr)
tdat1<- data.frame(Attrib_Otter= c(1:10), Income= mean(datES$Income), ESBID_1= mean(datES$ESBID_1))
Spr1<-predict(Esd3, newdata=tdat1, type= "probability")
df1<- cbind(df, Spr1)
ggplot(df, aes(x= Attrib_Otter, y= Spr)) +geom_line() + theme_themeo ()
Preds<-melt(df1,id.vars=c("Attrib_Otter", "Income", "OTBID_1"))
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking Score of Sea Otters") +theme_themeo() +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme( legend.justification= c(0.9,0.95), legend.position=c(0.9,0.95))
Pred2
ggsave("Fig4_OtterRank.pdf",Pred2, width=90,height=90, scale =1,units="mm")
ggsave("Fig4_OtterRank.png",Pred2, width=90, height=90,scale =1,units="mm")
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +theme_themeo() +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme( legend.justification= c(0.95,0.95), legend.position=c(0.95,0.95))
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +theme_themeo() +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme( legend.justification= c(0.95,0.95), legend.position=c(0.95,1))
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +theme_themeo() +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme( legend.justification= c(0.95,0.95), legend.position=c(0.95,0.98))
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +theme_themeo() +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme( legend.justification= c(0.95,0.95), legend.position=c(0.90,0.98))
Pred2
ggsave("Fig4_OtterRank.pdf",Pred2, width=90,height=90, scale =1,units="mm")
Pred1<-ggplot(Preds, aes(x=OTBID_1, y= value, color=variable)) +geom_smooth(method="loess", size=2) +scale_x_continuous(name="Proposed Fee Amount (USD)") +theme_themeo() +
scale_color_manual(breaks= c("Spred1","Spred"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,1), name="Probability of voting yes") + theme( legend.justification= c(0.9,0.9), legend.position=c(0.9,0.9)) +themeKV
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +theme_themeo() +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme( legend.justification= c(0.95,0.95), legend.position= "top")
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +theme_themeo() +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme( size= 12,legend.justification= c(0.95,0.95), legend.position= c(0.90,0.98))
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +theme_themeo() +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme( legend.text= element_text(size= 12),legend.justification= c(0.95,0.95), legend.position= c(0.90,0.98))
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +theme_themeo() +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme( legend.text= element_text(size= 10),legend.justification= c(0.95,0.95), legend.position= c(0.90,0.98))
Pred2
ggsave("Fig4_OtterRank.pdf",Pred2, width=90,height=90, scale =1,units="mm")
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +theme_themeo() +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme( legend.text= element_text(size= 10),legend.justification= c(0.95,0.95), legend.position= c(0.90,0))
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +theme_themeo() +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme( legend.text= element_text(size= 10),legend.justification= c(0.95,0.95), legend.position= c(0.90,0.4))
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +theme_themeo() +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme( legend.text= element_text(size= 10),legend.justification= c(0.95,0.95), legend.position= c(0.90,0.2))
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +theme_themeo() +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme( legend.text= element_text(size= 10),legend.justification= c(0.95,0.95), legend.position= c(0.95,0.2))
Pred2
ggsave("Fig4_OtterRank.pdf",Pred2, width=90,height=90, scale =1,units="mm")
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +theme_themeo() +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme( legend.text= element_text(size= 10),legend.justification= c(0.95,0.95), legend.position= c(0.95,0.3))
ggsave("Fig4_OtterRank.pdf",Pred2, width=90,height=90, scale =1,units="mm")
ggsave("Fig4_OtterRank.pdf",Pred2, width=90,height=90, scale =1,units="mm")
Pred2
ggsave("Fig4_OtterRank.pdf",Pred2, width=90,height=90, scale =1,units="mm")
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme( legend.text= element_text(size= 8),legend.justification= c(0.95,0.95), legend.position= c(0.95,0.3))
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme(legend.text= element_text(size= 8),legend.justification= c(0.95,0.95), legend.position= c(0.95,0.3))
theme_classic()+
theme(strip.background = element_blank(),
axis.line = element_blank(),
text=element_text(size=12),
axis.text.x = element_text(margin = margin( 0.2, unit = "cm")),
axis.text.y = element_text(margin = margin( c(1,0.2), unit = "cm")),
axis.ticks.length=unit(-0.1, "cm"),
panel.border = element_rect(colour = "black", fill=NA, size=.5),
legend.title=element_blank(),
strip.text=element_text(hjust=0) )
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme(legend.text= element_text(size= 8),legend.justification= c(0.95,0.95), legend.position= c(0.95,0.3))+
theme_classic()+
theme(strip.background = element_blank(),
axis.line = element_blank(),
text=element_text(size=12),
axis.text.x = element_text(margin = margin( 0.2, unit = "cm")),
axis.text.y = element_text(margin = margin( c(1,0.2), unit = "cm")),
axis.ticks.length=unit(-0.1, "cm"),
panel.border = element_rect(colour = "black", fill=NA, size=.5),
legend.title=element_blank(),
strip.text=element_text(hjust=0) )
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme(legend.text= element_text(size= 8),legend.justification= c(0.95,0.95), legend.position= c(0..5,0.3))+
theme_classic()+
theme(strip.background = element_blank(),
axis.line = element_blank(),
text=element_text(size=12),
axis.text.x = element_text(margin = margin( 0.2, unit = "cm")),
axis.text.y = element_text(margin = margin( c(1,0.2), unit = "cm")),
axis.ticks.length=unit(-0.1, "cm"),
panel.border = element_rect(colour = "black", fill=NA, size=.5),
legend.title=element_blank(),
strip.text=element_text(hjust=0) )
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme(legend.text= element_text(size= 8),legend.justification= c(0.95,0.95), legend.position= c(0..5,0.3))+
theme_classic()+
theme(strip.background = element_blank(),
axis.line = element_blank(),
text=element_text(size=12),
axis.text.x = element_text(margin = margin( 0.2, unit = "cm")),
axis.text.y = element_text(margin = margin( c(1,0.2), unit = "cm")),
axis.ticks.length=unit(-0.1, "cm"),
panel.border = element_rect(colour = "black", fill=NA, size=.5),
legend.title=element_blank(),
strip.text=element_text(hjust=0) )
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + theme(legend.text= element_text(size= 8),legend.justification= c(0.95,0.95), legend.position= c(0.5,0.3)) +
theme_classic()+
theme(strip.background = element_blank(),
axis.line = element_blank(),
text=element_text(size=12),
axis.text.x = element_text(margin = margin( 0.2, unit = "cm")),
axis.text.y = element_text(margin = margin( c(1,0.2), unit = "cm")),
axis.ticks.length=unit(-0.1, "cm"),
panel.border = element_rect(colour = "black", fill=NA, size=.5),
legend.title=element_blank(),
strip.text=element_text(hjust=0) )
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") +
theme_classic()+
theme(strip.background = element_blank(),
axis.line = element_blank(),
text=element_text(size=12),
axis.text.x = element_text(margin = margin( 0.2, unit = "cm")),
axis.text.y = element_text(margin = margin( c(1,0.2), unit = "cm")),
axis.ticks.length=unit(-0.1, "cm"),
panel.border = element_rect(colour = "black", fill=NA, size=.5),
legend.text= element_text(size= 8),
legend.justification= c(0.95,0.95),
legend.position= c(0.5,0.3),
legend.title=element_blank(),
strip.text=element_text(hjust=0) )
Pred1
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") +
theme_classic()+
theme(strip.background = element_blank(),
axis.line = element_blank(),
text=element_text(size=12),
axis.text.x = element_text(margin = margin( 0.2, unit = "cm")),
axis.text.y = element_text(margin = margin( c(1,0.2), unit = "cm")),
axis.ticks.length=unit(-0.1, "cm"),
panel.border = element_rect(colour = "black", fill=NA, size=.5),
legend.text= element_text(size= 10),
legend.justification= c(0.95,0.95),
legend.position= c(0.9,0.3),
legend.title=element_blank(),
strip.text=element_text(hjust=0) )
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") +
theme_classic()+
theme(strip.background = element_blank(),
axis.line = element_blank(),
text=element_text(size=12),
axis.text.x = element_text(margin = margin( 0.2, unit = "cm")),
axis.text.y = element_text(margin = margin( c(1,0.2), unit = "cm")),
axis.ticks.length=unit(-0.1, "cm"),
panel.border = element_rect(colour = "black", fill=NA, size=.5),
legend.text= element_text(size= 10),
legend.justification= c(0.95,0.95),
legend.position= c(0.95,0.3),
legend.title=element_blank(),
strip.text=element_text(hjust=0) )
Pred2
ggsave("Fig4_OtterRank.pdf",Pred2, width=90,height=90, scale =1,units="mm")
ggsave("Fig5_OtterRank.pdf",Pred2, width=90,height=90, scale =1,units="mm")
ggsave("Fig5_OtterRank.png",Pred2, width=90, height=90,scale =1,units="mm")
library(DCchoice)
install.packages("DCchoice",
repos = c("http://www.bioconductor.org/packages/release/bioc",
"https://cran.rstudio.com/"),
dep = TRUE)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.12")
BiocManager::install("Icens")
library(Incens)
library(tidyverse)
library(patchwork)
library(reshape2)
library(ggpubr)
library(cowplot)
library(here)
library(DCchoice)
library(Ecdat)
library(lmtest)
library(AICcmodavg)
library(scales)
library(ggplot2)
library(ggthemes)
install.packages("tidyverse")
install.packages("patchwork")
install.packages("AICcmodavg")
install.packages("cowplot")
library(tidyverse)
library(patchwork)
library(reshape2)
library(ggpubr)
library(cowplot)
library(here)
library(DCchoice)
library(Ecdat)
library(lmtest)
library(AICcmodavg)
library(scales)
library(ggplot2)
library(ggthemes)
############## Willingness to Pay Analyses ############
datWTP<-read.csv(paste0("C:/Users/",Sys.info()[7],"/Seaotter_tourism_econ_impact/data/WTPsurvey.csv"), header=T)
# Data exploration, average proportion of 'yes' responses for first bid amount
round(tapply(datWTP$ESR1, datWTP$ESBID_1, mean), 2)
round(tapply(datWTP$OTR1, datWTP$OTBID_1, mean), 2)
Sdb3<-dbchoice(OTR1 +OTR2 ~ 1 + log(Income) + Attrib_Otter  | OTBID_1 + OTBID_2,dist="logistic",na.rm=TRUE, data=datS)
## Sea Otter survey
datS<- datWTP %>% dplyr::select(OTR1, OTR2,Income, OTBID_1,OTBID_2, Attrib_Birds,Attrib_Unique,Attrib_Otter,Attrib_Fish, Attrib_Convenience, NVisits,MBA) %>% drop_na()
Sdb3<-dbchoice(OTR1 +OTR2 ~ 1 + log(Income) + Attrib_Otter  | OTBID_1 + OTBID_2,dist="logistic",na.rm=TRUE, data=datS)
datES<- datWTP %>% dplyr::select(ESR1, ESR2,Income, ESBID_1,ESBID_2, Attrib_Birds,Attrib_Unique,Attrib_Otter,
Attrib_Fish, Attrib_Convenience, NVisits,MBA, AGE) %>% drop_na()
Esd3<-dbchoice(ESR1 +ESR2 ~ 1 + log(Income) + Attrib_Otter | ESBID_1 + ESBID_2,dist="logistic", na.rm=TRUE, data=datES)
## Plot both WTP on single graph
## Calculate probabilities with mean otter rank and income, varying bid amount only
tst.data<- data.frame(Attrib_Otter= mean(datS$Attrib_Otter), Income= mean(datS$Income), OTBID_1=c(5:50))
Spred<- predict(Sdb3, newdata= tst.data, se.fit=TRUE, type="probability")
df<-cbind(tst.data,Spred)
df
df$se.fit
$se.fit
df
Spred<- predict(Sdb3, newdata= tst.data,  type="probability")
#se.fit=TRUE,
df<-cbind(tst.data,Spred)
sd
df
Spred
Spred<- predict(Sdb3, newdata= tst.data, se.fit=TRUE, type="probability")
Spred
tst.data<- data.frame(Attrib_Otter= mean(datS$Attrib_Otter), Income= mean(datS$Income), OTBID_1=c(5:50))
Spred<- predict(Sdb3, newdata= tst.data,  type="probability")
df<-cbind(tst.data,Spred)
tst.data1<- data.frame(Income=mean(datES$Income), Attrib_Otter=mean(datES$Attrib_Otter), ESBID_1=c(5:50))
Spred1<- Esd3 %>% predict(tst.data1, type="probability")
df1<-cbind(df,Spred1)
Preds<-melt(df1,id.vars=c("Attrib_Otter", "OTBID_1"))
Pred1<-ggplot(Preds, aes(x=OTBID_1, y= value, color=variable)) +geom_smooth(method="loess", size=2) +scale_x_continuous(name="Proposed Fee Amount (USD)")  +
scale_color_manual(breaks= c("Spred1","Spred"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,1), name="Probability of voting yes") + theme(legend.justification= c(0.9,0.9), legend.position=c(0.9,0.9)) +themeKV
library(ggthemes)
themeKV <- theme_few() +
theme(strip.background = element_blank(),
axis.line = element_blank(),
axis.title.x= element_text(size= 14,margin = margin(0.2, unit = "cm")),
axis.text.x = element_text(size=12,margin = margin(0.2, unit = "cm")),
axis.title.y= element_text(size= 14,margin = margin(0.2, unit = "cm")),
axis.text.y = element_text(size=12,margin = margin(c(1, 0.2), unit = "cm")),
axis.ticks.length=unit(-0.15, "cm"),element_line(colour = "black", size=.5),
panel.border = element_rect(colour = "black", fill=NA, size=.5),
legend.title=element_blank(),
strip.text=element_text(hjust=0))
tst.data<- data.frame(Attrib_Otter= mean(datS$Attrib_Otter), Income= mean(datS$Income), OTBID_1=c(5:50))
Spred<- predict(Sdb3, newdata= tst.data,  type="probability")
df<-cbind(tst.data,Spred)
tst.data1<- data.frame(Income=mean(datES$Income), Attrib_Otter=mean(datES$Attrib_Otter), ESBID_1=c(5:50))
Spred1<- Esd3 %>% predict(tst.data1, type="probability")
df1<-cbind(df,Spred1)
Preds<-melt(df1,id.vars=c("Attrib_Otter", "OTBID_1"))
Pred1<-ggplot(Preds, aes(x=OTBID_1, y= value, color=variable)) +geom_smooth(method="loess", size=2) +scale_x_continuous(name="Proposed Fee Amount (USD)")  +
scale_color_manual(breaks= c("Spred1","Spred"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,1), name="Probability of voting yes") + theme(legend.justification= c(0.9,0.9), legend.position=c(0.9,0.9)) +themeKV
Pred1
tdat<- data.frame(Attrib_Otter= c(1:10), Income= mean(datS$Income), OTBID_1= mean(datS$OTBID_1))
Spr<-predict(Sdb3, newdata=tdat, type= "probability")
df<- cbind(tdat, Spr)
tdat1<- data.frame(Attrib_Otter= c(1:10), Income= mean(datES$Income), ESBID_1= mean(datES$ESBID_1))
Spr1<-predict(Esd3, newdata=tdat1, type= "probability")
df1<- cbind(df, Spr1)
ggplot(df, aes(x= Attrib_Otter, y= Spr)) +geom_line() + theme_themeo ()
Preds<-melt(df1,id.vars=c("Attrib_Otter", "Income", "OTBID_1"))
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") +
theme_classic()+
theme(strip.background = element_blank(),
axis.line = element_blank(),
text=element_text(size=12),
axis.text.x = element_text(margin = margin( 0.2, unit = "cm")),
axis.text.y = element_text(margin = margin( c(1,0.2), unit = "cm")),
axis.ticks.length=unit(-0.1, "cm"),
panel.border = element_rect(colour = "black", fill=NA, size=.5),
legend.text= element_text(size= 10),
legend.justification= c(0.95,0.95),
legend.position= c(0.95,0.3),
legend.title=element_blank(),
strip.text=element_text(hjust=0) )
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + themeKV
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=1) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + themeKV +
theme(legend.text= element_text(size= 10),legend.justification= c(0.95,0.95),legend.position= c(0.95,0.3),
legend.title=element_blank(), strip.text=element_text(hjust=0))
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=3) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + themeKV +
theme(legend.text= element_text(size= 10),legend.justification= c(0.95,0.95),legend.position= c(0.95,0.3),
legend.title=element_blank(), strip.text=element_text(hjust=0))
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=0.8) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + themeKV +
theme(legend.text= element_text(size= 10),legend.justification= c(0.95,0.95),legend.position= c(0.95,0.3),
legend.title=element_blank(), strip.text=element_text(hjust=0))
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=0.9) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + themeKV +
theme(legend.text= element_text(size= 10),legend.justification= c(0.95,0.95),legend.position= c(0.95,0.3),
legend.title=element_blank(), strip.text=element_text(hjust=0))
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_smooth(size=0.9) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + themeKV +
theme(legend.text= element_text(size= 10),legend.justification= c(0.95,0.95),legend.position= c(0.95,0.3),
legend.title=element_blank(), strip.text=element_text(hjust=0))
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_smooth(size=0.9,se=T ) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + themeKV +
theme(legend.text= element_text(size= 10),legend.justification= c(0.95,0.95),legend.position= c(0.95,0.3),
legend.title=element_blank(), strip.text=element_text(hjust=0))
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=0.95) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("Spr","Spr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + themeKV +
theme(legend.text= element_text(size= 10),legend.justification= c(0.95,0.95),legend.position= c(0.95,0.3),
legend.title=element_blank(), strip.text=element_text(hjust=0))
Pred2
df1
tdat<- data.frame(Attrib_Otter= c(1:10), Income= mean(datS$Income), OTBID_1= mean(datS$OTBID_1))
SOpr<-predict(Sdb3, newdata=tdat, type= "probability")
df<- cbind(tdat, SOpr)
tdat1<- data.frame(Attrib_Otter= c(1:10), Income= mean(datES$Income), ESBID_1= mean(datES$ESBID_1))
ESpr1<-predict(Esd3, newdata=tdat1, type= "probability")
df1<- cbind(df, ESpr1)
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=0.95) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("SOpr","ESpr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + themeKV +
theme(legend.text= element_text(size= 10),legend.justification= c(0.95,0.95),legend.position= c(0.95,0.3),
legend.title=element_blank(), strip.text=element_text(hjust=0))
Pred2
Preds<-melt(df1,id.vars=c("Attrib_Otter", "Income", "OTBID_1"))
Preds
Preds<-melt(df1,id.vars=c("Attrib_Otter", "Income", "OTBID_1"))
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=0.95) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("SOpr","ESpr1"), labels=c("Elkhorn Slough", "Sea Otter"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + themeKV +
theme(legend.text= element_text(size= 10),legend.justification= c(0.95,0.95),legend.position= c(0.95,0.3),
legend.title=element_blank(), strip.text=element_text(hjust=0))
Pred2
Pred2<-ggplot(Preds, aes(x=Attrib_Otter, y= value, color=variable)) +geom_line(size=0.95) +scale_x_continuous(name="Ranking score of sea otters") +
scale_color_manual(breaks= c("SOpr","ESpr1"), labels=c("Sea Otter", "Elkhorn Slough"), values= c("#026AA4", "#990000" )) +
scale_y_continuous(limits= c(0,0.9), name="Probability of voting yes") + themeKV +
theme(legend.text= element_text(size= 10),legend.justification= c(0.95,0.95),legend.position= c(0.95,0.3),
legend.title=element_blank(), strip.text=element_text(hjust=0))
Pred2
ggsave("Fig5_OtterRank.pdf",Pred2, width=90,height=90, scale =1,dpi=800, units="mm")
ggsave("Fig5_OtterRank.png",Pred2, width=90, height=90,scale =1,dpi=800, units="mm")
