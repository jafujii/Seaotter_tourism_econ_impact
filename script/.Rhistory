library(tidyverse)
library(patchwork)
library(reshape2)
library(ggpubr)
library(cowplot)
library(here)
library(DCchoice)
library(Ecdat)
library(lmtest)
library(AICcmodavg)
library(Incens)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Icens")
############## Willingness to Pay Analyses ###############################################
datWTP<-read.csv(paste0("C:/Users/",Sys.info()[7],"/Seaotter_tourism_econ_impact/data/WTPsurvey.csv"), header=T)
## Re-run of model script from Colgan 11/8/2020
db.logit2<-dbchoice(OTR1+OTR2~log(Income)| log(OTBID_1)+log(OTBID_2),data=datWTP)
summary(db.logit2)
ggplot(datWTP, aes(x=log(OTBID_1), y=log(INCOME))) +geom_point()
ggplot(datWTP, aes(x=log(OTBID_1), y=log(Income))) +geom_point()
ggplot(datWTP, aes(y=log(OTBID_1), x=log(Income))) +geom_point()
Esd1<-dbchoice(ESR1 +ESR2 ~ 1 + log(Income) | ESBID_1 + ESBID_2,dist="log-logistic",na.rm=TRUE, data=datES) # Reported model
datES<- datWTP %>% dplyr::select(ESR1, ESR2,Income, ESBID_1,ESBID_2, Attrib_Birds,Attrib_Unique,Attrib_Otter,
Attrib_Fish, Attrib_Convenience, NVisits,MBA) %>% drop_na()
Esd1<-dbchoice(ESR1 +ESR2 ~ 1 + log(Income) | ESBID_1 + ESBID_2,dist="log-logistic",na.rm=TRUE, data=datES) # Reported model
summary(Esd1)
Esd1<-dbchoice(ESR1 +ESR2 ~ 1 + log(Income) | ESBID_1 + ESBID_2,dist="logistic",na.rm=TRUE, data=datES) # Reported model
summary(Esd1)
hist(log(ESBID_1))
hist(log(datES$ESBID_1))
hist(datES$ESBID_1)
hist(datES$Income)
hist(log(datES$Income)
)
Esd1<-dbchoice(ESR1 +ESR2 ~ 1 + log(Income) | ESBID_1 + ESBID_2,dist="normal",na.rm=TRUE, data=datES) # Reported model
summary(Esd1)
Esd1<-dbchoice(ESR1 +ESR2 ~ 1 + log(Income) | ESBID_1 + ESBID_2,dist="log-logistic",na.rm=TRUE, data=datES) # Reported model
summary(Esd1)
Esd1<-dbchoice(ESR1 +ESR2 ~ 1 + log(Income) | ESBID_1 + ESBID_2,dist="logistic",na.rm=TRUE, data=datES) # Reported model
summary(Esd1)
## Re-run of model script from Colgan 11/8/2020, This gets the higher mean that they reported
db.logit2<-dbchoice(OTR1+OTR2~log(Income)| log(OTBID_1)+log(OTBID_2),dist="log-logistic",data=datWTP)
summary(db.logit2)
## Re-run of model script from Colgan 11/8/2020, This gets the higher mean that they reported
db.logit2<-turbull.db(OTR1+OTR2~log(Income)| log(OTBID_1)+log(OTBID_2),dist="log-logistic",data=datWTP)
## Re-run of model script from Colgan 11/8/2020, This gets the higher mean that they reported
db.logit2<-turnbull.db(OTR1+OTR2~log(Income)| log(OTBID_1)+log(OTBID_2),dist="log-logistic",data=datWTP)
plot(db.logit2)
## Re-run of model script from Colgan 11/8/2020, This gets the higher mean that they reported
db.logit2<-dbchoice(OTR1+OTR2~log(Income)| log(OTBID_1)+log(OTBID_2),dist="logistic",data=datWTP)
summary(db.logit2)
exp(3.344665)
## Re-run of model script from Colgan 11/8/2020, This gets the higher mean that they reported
db.logit2<-dbchoice(OTR1+OTR2~log(Income)| log(OTBID_1)+log(OTBID_2),data=datWTP)
summary(db.logit2)
## Re-run of model script from Colgan 11/8/2020, This gets the higher mean that they reported
db.logit2<-dbchoice(OTR1+OTR2~log(Income)| OTBID_1+OTBID_2,data=datWTP)
summary(db.logit2)
db.logit3<- dbchoice(ESR1+ESR2~log(Income)| log(ESBID_1)+log(ESBID_2),data=datWTP)
summary(db.logit3)
library(tidyverse)
library(patchwork)
library(reshape2)
library(ggpubr)
library(cowplot)
library(here)
library(DCchoice)
library(Ecdat)
library(lmtest)
library(AICcmodavg)
library(Incens)
library(BiocManager)
# Package required for DCchoice that no longer installs automatically
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Icens")
############## Willingness to Pay Analyses ###############################################
datWTP<-read.csv(paste0("C:/Users/",Sys.info()[7],"/Seaotter_tourism_econ_impact/data/WTPsurvey.csv"), header=T)
## Re-run of model script from Colgan 11/8/2020, This gets the higher mean that they reported.
#Difference is log of bid amounts and use of default distribution (log-logistic). Truncated means are more in line with my results
db.logit2<-dbchoice(OTR1+OTR2~log(Income)| log(OTBID_1)+log(OTBID_2),data=datWTP)
summary(db.logit2)
## Re-run of model script from Colgan 11/8/2020, This gets the higher mean that they reported.
#Difference is log of bid amounts and use of default distribution (log-logistic). Truncated means are more in line with my results
db.logit2<-dbchoice(OTR1+OTR2~log(Income)| OTBID_1+OTBID_2, dist= "logistic",data=datWTP)
summary(db.logit2)
## Re-run of model script from Colgan 11/8/2020, This gets the higher mean that they reported.
#Difference is log of bid amounts and use of default distribution (log-logistic). Truncated means are more in line with my results
db.logit2<-dbchoice(OTR1+OTR2~log(Income)| log(OTBID_1)+log(OTBID_2), dist="logistic",data=datWTP)
summary(db.logit2)
hit(datWTP$OTBID_1)
hist(datWTP$OTBID_1)
hist(log(datWTP$OTBID_1)
)
table(datWTP$OTBID_1, datWTP$OTR1)
